<title>js13k</title><meta name=viewport content="width=device-width,initial-scale=1,user-scalable=0,minimal-ui"><meta name=apple-mobile-web-app-capable content=yes><meta name=apple-mobile-web-app-status-bar-style content=black><style>body{background:#000;overflow:hidden}#g{background:#111;bottom:0;left:0;margin:auto;position:absolute;right:0;top:0}canvas{display:block}</style><div id=g></div><script>function SfxrParams(){this.setSettings=function(t){for(var e=0;24>e;e++)this[String.fromCharCode(97+e)]=t[e]||0;this.c<.01&&(this.c=.01);var i=this.b+this.c+this.e;if(.18>i){var n=.18/i;this.b*=n,this.c*=n,this.e*=n}}}function SfxrSynth(){this._params=new SfxrParams;var t,e,i,n,s,a,o,r,h,g,c,l;this.reset=function(){var t=this._params;n=100/(t.f*t.f+.001),s=100/(t.g*t.g+.001),a=1-t.h*t.h*t.h*.01,o=-t.i*t.i*t.i*1e-6,t.a||(c=.5-t.n/2,l=5e-5*-t.o),r=1+t.l*t.l*(t.l>0?-.9:10),h=0,g=1==t.m?0:(1-t.m)*(1-t.m)*2e4+32},this.totalReset=function(){this.reset();var n=this._params;return t=n.b*n.b*1e5,e=n.c*n.c*1e5,i=n.e*n.e*1e5+12,3*((t+e+i)/3|0)},this.synthWave=function(u,p){var f=this._params,d=1!=f.s||f.v,m=f.v*f.v*.1,y=1+3e-4*f.w,S=f.s*f.s*f.s*.1,v=1+1e-4*f.t,w=1!=f.s,b=f.x*f.x,x=f.g,_=f.q||f.r,j=f.r*f.r*f.r*.2,k=f.q*f.q*(f.q<0?-1020:1020),I=f.p?((1-f.p)*(1-f.p)*2e4|0)+32:0,M=f.d,A=f.j/2,O=f.k*f.k*.01,P=f.a,L=t,T=1/t,q=1/e,C=1/i,G=5/(1+f.u*f.u*20)*(.01+S);G>.8&&(G=.8),G=1-G;for(var E,N,D,R,U,J,W=!1,B=0,F=0,$=0,z=0,H=0,K=0,Q=0,V=0,X=0,Y=0,Z=new Array(1024),te=new Array(32),ee=Z.length;ee--;)Z[ee]=0;for(var ee=te.length;ee--;)te[ee]=2*Math.random()-1;for(var ee=0;p>ee;ee++){if(W)return ee;if(I&&++X>=I&&(X=0,this.reset()),g&&++h>=g&&(g=0,n*=r),a+=o,n*=a,n>s&&(n=s,x>0&&(W=!0)),N=n,A>0&&(Y+=O,N*=1+Math.sin(Y)*A),N|=0,8>N&&(N=8),P||(c+=l,0>c?c=0:c>.5&&(c=.5)),++F>L)switch(F=0,++B){case 1:L=e;break;case 2:L=i}switch(B){case 0:$=F*T;break;case 1:$=1+2*(1-F*q)*M;break;case 2:$=1-F*C;break;case 3:$=0,W=!0}_&&(k+=j,D=0|k,0>D?D=-D:D>1023&&(D=1023)),d&&y&&(m*=y,1e-5>m?m=1e-5:m>.1&&(m=.1)),J=0;for(var ie=8;ie--;){if(Q++,Q>=N&&(Q%=N,3==P))for(var ne=te.length;ne--;)te[ne]=2*Math.random()-1;switch(P){case 0:U=c>Q/N?.5:-.5;break;case 1:U=1-Q/N*2;break;case 2:R=Q/N,R=6.28318531*(R>.5?R-1:R),U=1.27323954*R+.405284735*R*R*(0>R?1:-1),U=.225*((0>U?-1:1)*U*U-U)+U;break;case 3:U=te[Math.abs(32*Q/N|0)]}d&&(E=K,S*=v,0>S?S=0:S>.1&&(S=.1),w?(H+=(U-K)*S,H*=G):(K=U,H=0),K+=H,z+=K-E,z*=1-m,U=z),_&&(Z[V%1024]=U,U+=Z[(V-D+1024)%1024],V++),J+=U}J*=.125*$*b,u[ee]=J>=1?32767:-1>=J?-32768:32767*J|0}return p}}var synth=new SfxrSynth;window.jsfxr=function(t){synth._params.setSettings(t);var e=synth.totalReset(),i=new Uint8Array(4*((e+1)/2|0)+44),n=2*synth.synthWave(new Uint16Array(i.buffer,44),e),s=new Uint32Array(i.buffer,0,44);s[0]=1179011410,s[1]=n+36,s[2]=1163280727,s[3]=544501094,s[4]=16,s[5]=65537,s[6]=44100,s[7]=88200,s[8]=1048578,s[9]=1635017060,s[10]=n,n+=44;for(var a=0,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r="data:audio/wav;base64,";n>a;a+=3){var h=i[a]<<16|i[a+1]<<8|i[a+2];r+=o[h>>18]+o[h>>12&63]+o[h>>6&63]+o[63&h]}return r},g={},g.Group=function(){this.collection=[],this.length=0},g.Group.prototype.add=function(t){this.collection.push(t),this.length++},g.Group.prototype.remove=function(t){t<this.length&&(this.collection.splice(t,1),this.length--)},g.Group.prototype.empty=function(){this.collection.length=0,this.length=0},g.Group.prototype.each=function(t,e){var i;if(e)for(i=0;i<this.length;i++)this.collection[i][t](i);else for(i=this.length;i--;)this.collection[i][t](i)},g.Pool=function(t,e){this.base=t,this.preallocateAmount=e||0,this.alive=[],this.dead=[],this.length=0,this.deadLength=0,this.preallocateAmount&&this.preallocate()},g.Pool.prototype.preallocate=function(){for(var t=0;t<this.preallocateAmount;t++)this.dead.push(new this.base),this.deadLength++},g.Pool.prototype.create=function(t){if(this.deadLength){var e=this.dead.pop();e.init(t),this.alive.push(e),this.deadLength--,this.length++}else this.alive.push(new this.base(t)),this.length++},g.Pool.prototype.release=function(t){var e=this.alive.indexOf(t);e>-1&&(this.dead.push(this.alive.splice(e,1)[0]),this.length--,this.deadLength++)},g.Pool.prototype.empty=function(){this.alive.length=0,this.dead.length=0,this.length=0,this.deadLength=0},g.Pool.prototype.each=function(t,e){var i;if(e)for(i=0;i<this.length;i++)this.alive[i][t](i);else for(i=this.length;i--;)this.alive[i][t](i)},g.util={},g.util.roundToNearest=function(t,e){return Math.round(t/e)*e},g.util.rand=function(t,e){return g.m.random()*(e-t)+t},g.util.randInt=function(t,e){return g.m.floor(g.m.random()*(e-t+1))+t},g.util.rangeIntersect=function(t,e,i,n){return Math.max(t,e)>Math.min(i,n)&&Math.min(t,e)<Math.max(i,n)},g.util.rectIntersect=function(t,e){return g.util.rangeIntersect(t.x,t.x+t.width,e.x,e.x+e.width)&&g.util.rangeIntersect(t.y,t.y+t.height,e.y,e.y+e.height)},g.util.format={},g.util.format.pad=function(t,e){return t+="",t.length<e?(t="0"+t,g.util.format.pad(t,e)):t},g.util.format.time=function(t){var e=g.m.floor(t/60);return t=g.m.floor(t%60),g.util.format.pad(e,2)+":"+g.util.format.pad(t,2)},g.util.format.numCommas=function(t){t+="";for(var e=t.split("."),i=e[0],n=e.length>1?"."+e[1]:"",s=/(\d+)(\d{3})/;s.test(i);)i=i.replace(s,"$1,$2");return i+n},g.util.isset=function(t){return"undefined"!=typeof t},g.util.objIsEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},g.util.merge=function(t,e){for(var i in e)t[i]=e[i]},g.states={},g.addState=function(t,e){g.states[t]=new g.State(e)},g.setState=function(t){g.state&&(g.prevState=g.currentState(),g.states[g.state]._exit()),g.state=t,g.states[g.state]._init()},g.currentState=function(){return g.states[g.state]},g.State=function(t){g.util.merge(this,t),this.init=g.util.isset(this.init)?this.init:function(){},this.step=g.util.isset(this.step)?this.step:function(){},this.draw=g.util.isset(this.draw)?this.draw:function(){},this.exit=g.util.isset(this.exit)?this.exit:function(){}},g.State.prototype._init=function(){this.time=new g.Time,this.init()},g.State.prototype._step=function(){this.time._step(),this.step()},g.State.prototype._draw=function(){this.draw()},g.State.prototype._exit=function(){this.exit()},g.Time=function(){this._init()},g.Time.prototype._init=function(){this.now=Date.now(),this.last=Date.now(),this.delta=16,this.ndelta=1,this.elapsed=0,this.nelapsed=0,this.tick=0},g.Time.prototype._step=function(){this.now=Date.now(),this.delta=this.now-this.last,this.ndelta=Math.min(Math.max(this.delta/(1e3/60),1e-4),10),this.elapsed+=this.delta,this.nelapsed+=this.ndelta,this.last=this.now,this.tick++},Storage.prototype.setObject=function(t,e){this.setItem(t,JSON.stringify(e))},Storage.prototype.getObject=function(t){var e=this.getItem(t);return e&&JSON.parse(e)},Storage.prototype.removeObject=function(t){this.removeItem(t)},g.Storage=function(t){this.namespace=t,this.obj=localStorage.getObject(this.namespace)||{}},g.Storage.prototype.get=function(t){return this.obj[t]},g.Storage.prototype.set=function(t,e){this.obj[t]=e,this.sync()},g.Storage.prototype.sync=function(){localStorage.setObject(this.namespace,this.obj)},g.Storage.reset=function(){this.obj={},this.sync()};var StateSplash=function(){};StateSplash.prototype.init=function(){},StateSplash.prototype.step=function(){},StateSplash.prototype.draw=function(){g.ctx.fillStyle="#fff",g.ctx.fillRect(100,100,100,100)},StateSplash.prototype.exit=function(){},g.addState("splash",new StateSplash),g.config={namespace:"gameName",width:800,height:600,state:"splash"},g._init=function(){g.time=new g.Time,g.dom=document.getElementById("g"),g.c=document.createElement("canvas"),g.ctx=g.c.getContext("2d"),g.c.width=g.width=g.config.width,g.c.height=g.height=g.config.height,g.dom.style.width=g.width+"px",g.dom.style.height=g.height+"px",g.dom.appendChild(g.c),g.storage=new g.Storage(g.config.namespace),g.util.objIsEmpty(g.storage.obj)&&g.storage.set("option",0),g.lastState=null,g.setState(g.config.state),g._step()},g._step=function(){requestAnimationFrame(g._step),g.time._step(),g.states[g.state]._step(),g.states[g.state]._draw()},g._init();</script>